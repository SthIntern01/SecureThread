<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Security Report - {{ repository.name }}</title>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover-page">
        <div class="cover-content">
            <div class="cover-logo">üõ°Ô∏è</div>
            <h1 class="cover-title">Executive Security Report</h1>
            <p class="cover-subtitle">{{ repository.name }}</p>
            
            <div class="cover-info">
                <div class="cover-info-grid">
                    <div class="cover-info-item">
                        <div class="cover-info-label">Report ID</div>
                        <div class="cover-info-value">{{ metadata.report_id }}</div>
                    </div>
                    <div class="cover-info-item">
                        <div class="cover-info-label">Repository</div>
                        <div class="cover-info-value">{{ repository.full_name }}</div>
                    </div>
                    <div class="cover-info-item">
                        <div class="cover-info-label">Assessment Date</div>
                        <div class="cover-info-value">{{ scan.completed_at|datetime_format('date') }}</div>
                    </div>
                    <div class="cover-info-item">
                        <div class="cover-info-label">Risk Level</div>
                        <div class="cover-info-value">{{ security.risk_level }}</div>
                    </div>
                </div>
                
                <div class="cover-footer">
                    <p><strong>{{ metadata.company }}</strong></p>
                    <p>{{ metadata.tagline }}</p>
                    <p class="mt-4"><strong>{{ metadata.classification }}</strong></p>
                    <p>{{ metadata.distribution }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Table of Contents -->
    <div class="toc-page">
        <div class="toc-container">
            <h1 class="toc-title">Table of Contents</h1>
            
            <div class="toc-section">
                <div class="toc-section-title">Executive Overview</div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">1</span>
                        <span class="toc-item-title">Executive Summary</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">3</span>
                </div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">2</span>
                        <span class="toc-item-title">Risk Assessment</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">4</span>
                </div>
            </div>
            
            <div class="toc-section">
                <div class="toc-section-title">Business Impact</div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">3</span>
                        <span class="toc-item-title">Financial Impact Analysis</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">5</span>
                </div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">4</span>
                        <span class="toc-item-title">Compliance & Risk</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">6</span>
                </div>
            </div>
            
            <div class="toc-section">
                <div class="toc-section-title">Strategic Recommendations</div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">5</span>
                        <span class="toc-item-title">Implementation Roadmap</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">7</span>
                </div>
                <div class="toc-item">
                    <div class="toc-item-content">
                        <span class="toc-item-number">6</span>
                        <span class="toc-item-title">Investment & ROI</span>
                    </div>
                    <div class="toc-item-dots"></div>
                    <span class="toc-item-page">8</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Executive Summary -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 1</div>
        <h1 class="section-title">Executive Summary</h1>
        <p class="section-description">
            Comprehensive security assessment overview and key findings for executive leadership
        </p>
    </div>

    <div class="card card-primary">
        <h3>Assessment Overview</h3>
        <p>{{ metadata.company }} conducted a comprehensive security assessment of <strong>{{ repository.full_name }}</strong> 
           using our enterprise-grade scanning platform. The assessment identified <strong>{{ security.total_vulnerabilities }}</strong> 
           security findings with an overall risk classification of <strong class="text-{{ security.risk_level|lower }}">{{ security.risk_level }}</strong>.</p>
    </div>

    <!-- Key Metrics Dashboard -->
    <div class="stats-grid-4">
        <div class="stat-card">
            <div class="stat-number stat-critical">{{ security.severity_counts.critical }}</div>
            <div class="stat-label">Critical Issues</div>
            <div class="stat-change text-critical">Immediate Action Required</div>
        </div>
        <div class="stat-card">
            <div class="stat-number stat-high">{{ security.severity_counts.high }}</div>
            <div class="stat-label">High Priority</div>
            <div class="stat-change text-high">2-Week Timeline</div>
        </div>
        <div class="stat-card">
            <div class="stat-number stat-success">{{ "%.0f"|format(security.security_score) }}%</div>
            <div class="stat-label">Security Score</div>
            <div class="stat-change text-success">{{ "%.0f"|format(security.improvement_potential) }}% Improvement Potential</div>
        </div>
        <div class="stat-card">
            <div class="stat-number stat-success">{{ business.roi_percentage|currency }}</div>
            <div class="stat-label">Investment ROI</div>
            <div class="stat-change text-success">{{ "%.1f"|format(business.payback_period_months) }} Month Payback</div>
        </div>
    </div>

    <!-- Critical Findings Alert -->
    {% if security.severity_counts.critical > 0 %}
    <div class="alert alert-critical">
        <div class="alert-title">Immediate Executive Action Required</div>
        <p><strong>{{ security.severity_counts.critical }}</strong> critical security vulnerabilities require immediate C-level attention and resource allocation. These issues pose significant risk to business operations and must be addressed within 24-48 hours.</p>
        <ul class="mt-3">
            <li><strong>Business Risk:</strong> {{ business.business_risk_level }}</li>
            <li><strong>Compliance Impact:</strong> {{ business.compliance_impact }}</li>
            <li><strong>Potential Cost:</strong> {{ business.potential_cost|currency }}</li>
        </ul>
    </div>
    {% endif %}

    <!-- Security Posture Assessment -->
    <div class="card card-elevated">
        <h3>Current Security Posture: {{ security.security_posture }}</h3>
        <div class="stats-grid">
            <div>
                <h4>Risk Profile</h4>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Overall Risk Level</span>
                        <span>{{ security.risk_level }}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ security.risk_score * 10 }}%"></div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Security Maturity</span>
                        <span>{{ analysis.technology_analysis.security_maturity }}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ security.security_score }}%"></div>
                    </div>
                </div>
            </div>
            
            <div>
                <h4>Compliance Status</h4>
                {% for framework, score in compliance.compliance_scores.items() %}
                <div class="progress-container">
                    <div class="progress-label">
                        <span>{{ framework }}</span>
                        <span>{{ "%.0f"|format(score) }}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ score }}%"></div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Risk Assessment -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 2</div>
        <h1 class="section-title">Risk Assessment</h1>
        <p class="section-description">
            Comprehensive analysis of security risks and their potential business impact
        </p>
    </div>

    <!-- Risk Matrix -->
    <div class="card">
        <h3>Enterprise Risk Matrix</h3>
        <table class="risk-matrix">
            <thead>
                <tr>
                    <th>Severity Level</th>
                    <th>Count</th>
                    <th>Business Impact</th>
                    <th>Timeline</th>
                    <th>Estimated Cost</th>
                </tr>
            </thead>
            <tbody>
                <tr class="risk-critical">
                    <td><span class="badge badge-critical">Critical</span></td>
                    <td><strong>{{ security.severity_counts.critical }}</strong></td>
                    <td>System compromise, data breach, regulatory fines</td>
                    <td>24-48 hours</td>
                    <td>{{ (security.severity_counts.critical * 50000)|currency }}</td>
                </tr>
                <tr class="risk-high">
                    <td><span class="badge badge-high">High</span></td>
                    <td><strong>{{ security.severity_counts.high }}</strong></td>
                    <td>Significant security gaps, potential data exposure</td>
                    <td>1-2 weeks</td>
                    <td>{{ (security.severity_counts.high * 25000)|currency }}</td>
                </tr>
                <tr class="risk-medium">
                    <td><span class="badge badge-medium">Medium</span></td>
                    <td><strong>{{ security.severity_counts.medium }}</strong></td>
                    <td>Moderate security concerns, limited exposure</td>
                    <td>1 month</td>
                    <td>{{ (security.severity_counts.medium * 10000)|currency }}</td>
                </tr>
                <tr class="risk-low">
                    <td><span class="badge badge-low">Low</span></td>
                    <td><strong>{{ security.severity_counts.low }}</strong></td>
                    <td>Minor security issues, best practice gaps</td>
                    <td>Next quarter</td>
                    <td>{{ (security.severity_counts.low * 2500)|currency }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Attack Vector Analysis -->
    {% if analysis.attack_vectors %}
    <div class="card card-warning">
        <h3>Primary Attack Vectors</h3>
        <div class="stats-grid">
            {% for vector in analysis.attack_vectors %}
            <div class="alert alert-{{ vector.risk|lower }}">
                <div class="alert-title">{{ vector.vector }}</div>
                <p>{{ vector.description }}</p>
                <p><strong>Occurrences:</strong> {{ vector.count }} | <strong>Risk Level:</strong> {{ vector.risk }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Financial Impact Analysis -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 3</div>
        <h1 class="section-title">Financial Impact Analysis</h1>
        <p class="section-description">
            Comprehensive financial analysis of security risks and investment requirements
        </p>
    </div>

    <div class="stats-grid">
        <div class="card card-danger">
            <h4>Potential Risk Exposure</h4>
            <div class="stat-number text-critical">{{ business.potential_cost|currency }}</div>
            <p>Total potential cost of security incidents if vulnerabilities are exploited</p>
            
            <div class="mt-4">
                <h5>Risk Breakdown:</h5>
                <ul>
                    <li>Data breach costs: {{ (business.potential_cost * 0.4)|currency }}</li>
                    <li>Regulatory fines: {{ (business.potential_cost * 0.3)|currency }}</li>
                    <li>Business disruption: {{ (business.potential_cost * 0.2)|currency }}</li>
                    <li>Reputation damage: {{ (business.potential_cost * 0.1)|currency }}</li>
                </ul>
            </div>
        </div>

        <div class="card card-success">
            <h4>Investment Requirements</h4>
            <div class="stat-number text-success">{{ business.remediation_cost|currency }}</div>
            <p>Estimated investment required to address all identified security issues</p>
            
            <div class="mt-4">
                <h5>Investment Breakdown:</h5>
                <ul>
                    <li>Development resources: {{ (business.remediation_cost * 0.6)|currency }}</li>
                    <li>Security tools: {{ (business.remediation_cost * 0.2)|currency }}</li>
                    <li>Training & process: {{ (business.remediation_cost * 0.1)|currency }}</li>
                    <li>External consulting: {{ (business.remediation_cost * 0.1)|currency }}</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ROI Analysis -->
    <div class="card card-primary">
        <h3>Return on Investment Analysis</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number stat-success">{{ business.cost_avoidance|currency }}</div>
                <div class="stat-label">Cost Avoidance</div>
                <div class="stat-change">Potential losses prevented</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-success">{{ "%.0f"|format(business.roi_percentage) }}%</div>
                <div class="stat-label">ROI Percentage</div>
                <div class="stat-change">Return on security investment</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-success">{{ "%.1f"|format(business.payback_period_months) }}</div>
                <div class="stat-label">Payback Period</div>
                <div class="stat-change">Months to break even</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-success">{{ resources.timeline_weeks|round|int }}</div>
                <div class="stat-label">Implementation</div>
                <div class="stat-change">Weeks to complete</div>
            </div>
        </div>
    </div>

    <!-- Compliance & Regulatory Impact -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 4</div>
        <h1 class="section-title">Compliance & Risk</h1>
        <p class="section-description">
            Assessment of regulatory compliance status and associated risks
        </p>
    </div>

    <div class="card">
        <h3>Regulatory Compliance Status</h3>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Framework</th>
                    <th>Compliance Score</th>
                    <th>Status</th>
                    <th>Key Gaps</th>
                    <th>Risk Level</th>
                </tr>
            </thead>
            <tbody>
                {% for framework, score in compliance.compliance_scores.items() %}
                <tr>
                    <td><strong>{{ framework }}</strong></td>
                    <td>{{ "%.0f"|format(score) }}%</td>
                    <td>
                        {% if score >= 90 %}
                        <span class="badge badge-success">Compliant</span>
                        {% elif score >= 70 %}
                        <span class="badge badge-medium">Partial</span>
                        {% else %}
                        <span class="badge badge-critical">Non-Compliant</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if score < 90 %}
                        Technical vulnerabilities, process gaps
                        {% else %}
                        Minor documentation updates
                        {% endif %}
                    </td>
                    <td>
                        {% if score >= 90 %}
                        <span class="text-success">Low</span>
                        {% elif score >= 70 %}
                        <span class="text-medium">Medium</span>
                        {% else %}
                        <span class="text-critical">High</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Business Impact Summary -->
    <div class="stats-grid">
        <div class="card">
            <h4>Operational Impact</h4>
            <p><strong>Assessment:</strong> {{ business.operational_impact }}</p>
            <p>Current security vulnerabilities may impact daily business operations and system availability.</p>
        </div>
        
        <div class="card">
            <h4>Reputation Risk</h4>
            <p><strong>Assessment:</strong> {{ business.reputation_impact }}</p>
            <p>Security incidents could significantly impact brand reputation and customer trust.</p>
        </div>
    </div>

    <!-- Implementation Roadmap -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 5</div>
        <h1 class="section-title">Implementation Roadmap</h1>
        <p class="section-description">
            Strategic implementation plan with phases, timelines, and success metrics
        </p>
    </div>

    {% for phase_key, phase in recommendations.implementation_roadmap.items() %}
    <div class="card page-break-avoid">
        <h3>{{ phase.name }} ({{ phase.duration }})</h3>
        
        <div class="recommendation-section">
            <div class="recommendation-header">
                <div class="recommendation-icon">{{ loop.index }}</div>
                <div class="recommendation-title">Phase {{ loop.index }} Actions</div>
            </div>
            
            {% for action in phase.actions %}
            <div class="recommendation-item">
                <div class="recommendation-priority priority-{{ action.priority|lower }}">{{ action.priority }}</div>
                <h5>{{ action.action }}</h5>
                <div class="stats-grid" style="margin-top: 12px;">
                    <div>
                        <strong>Timeline:</strong> {{ action.timeline }}<br>
                        <strong>Effort:</strong> {{ action.effort }}
                    </div>
                    <div>
                        <strong>Cost:</strong> {{ action.cost }}<br>
                        <strong>Resources:</strong> {{ action.resources }}
                    </div>
                </div>
                <p style="margin-top: 8px;"><strong>Impact:</strong> {{ action.impact }}</p>
            </div>
            {% endfor %}
        </div>
        
        <div class="alert alert-info">
            <div class="alert-title">Success Metrics</div>
            <ul>
                {% for metric in phase.success_metrics %}
                <li>{{ metric }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endfor %}

    <!-- Investment & ROI -->
    <div class="section-header page-break-before">
        <div class="section-number">Section 6</div>
        <h1 class="section-title">Investment & ROI</h1>
        <p class="section-description">
            Detailed analysis of investment requirements and expected returns
        </p>
    </div>

    <div class="card card-primary">
        <h3>Resource Requirements</h3>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Resource Type</th>
                    <th>Allocation</th>
                    <th>Cost</th>
                    <th>Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Development Team</td>
                    <td>{{ resources.developer_days }} developer days</td>
                    <td>{{ (resources.developer_days * 800)|currency }}</td>
                    <td>{{ resources.timeline_weeks|round|int }} weeks</td>
                </tr>
                <tr>
                    <td>Security Specialist</td>
                    <td>{{ resources.security_specialist_days|round|int }} specialist days</td>
                    <td>{{ (resources.security_specialist_days * 1200)|currency }}</td>
                    <td>Ongoing consultation</td>
                </tr>
                <tr>
                    <td>Project Management</td>
                    <td>{{ resources.project_manager_days|round|int }} PM days</td>
                    <td>{{ (resources.project_manager_days * 1000)|currency }}</td>
                    <td>Full project duration</td>
                </tr>
                <tr>
                    <td><strong>Total Investment</strong></td>
                    <td>-</td>
                    <td><strong>{{ business.remediation_cost|currency }}</strong></td>
                    <td><strong>{{ resources.timeline_weeks|round|int }} weeks</strong></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Strategic Initiatives -->
    <div class="card">
        <h3>Strategic Security Initiatives</h3>
        {% for initiative in recommendations.strategic_initiatives %}
        <div class="recommendation-item">
            <h4>{{ initiative.initiative }}</h4>
            <p>{{ initiative.description }}</p>
            <div class="stats-grid" style="margin-top: 12px;">
                <div>
                    <strong>Timeline:</strong> {{ initiative.timeline }}<br>
                    <strong>Investment:</strong> {{ initiative.investment }}
                </div>
                <div>
                    <strong>Expected ROI:</strong> {{ initiative.roi }}<br>
                    <strong>Strategic Value:</strong> High
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Executive Recommendations -->
    <div class="alert alert-info page-break-avoid">
        <div class="alert-title">Executive Recommendations</div>
        <ol>
            {% if security.severity_counts.critical > 0 %}
            <li><strong>Immediate Crisis Response:</strong> Establish emergency security task force to address {{ security.severity_counts.critical }} critical vulnerabilities within 48 hours.</li>
            {% endif %}
            <li><strong>Security Investment Approval:</strong> Approve {{ business.remediation_cost|currency }} security investment to achieve {{ "%.0f"|format(business.roi_percentage) }}% ROI.</li>
            <li><strong>Governance Enhancement:</strong> Implement security governance framework with regular executive reporting.</li>
            <li><strong>Strategic Security Program:</strong> Launch comprehensive DevSecOps initiative to prevent future security debt.</li>
            <li><strong>Compliance Alignment:</strong> Prioritize compliance gaps to reduce regulatory risk exposure.</li>
        </ol>
    </div>

    <!-- Report Footer -->
    <div class="report-footer">
        <div class="footer-logo">üõ°Ô∏è</div>
        <div class="footer-company">{{ metadata.company }}</div>
        <div class="footer-tagline">{{ metadata.tagline }}</div>
        <div style="margin: 20px 0;">
            <strong>Report Generated:</strong> {{ metadata.generated_at|datetime_format }} <br>
            <strong>Analyst:</strong> {{ metadata.analyst.name }}, {{ metadata.analyst.title }} <br>
            <strong>Contact:</strong> {{ metadata.analyst.email }}
        </div>
        <div class="footer-confidential">{{ metadata.classification }} - {{ metadata.distribution }}</div>
    </div>
</body>
</html>